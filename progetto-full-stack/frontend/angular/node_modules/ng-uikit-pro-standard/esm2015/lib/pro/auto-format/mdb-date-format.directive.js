import { Directive, HostListener, Input } from '@angular/core';
import * as ɵngcc0 from '@angular/core';
export class MdbDateFormatDirective {
    constructor() {
        this.separator = '/';
        this.format = ['dd', 'mm', 'yyyy'];
    }
    onInput(event) {
        const currentValue = event.target.value;
        const newValue = this.getFormattedDate(currentValue);
        event.target.value = newValue;
    }
    ngOnInit() {
        this.setSeparatorsNumber();
        this.setResultLength();
    }
    setSeparatorsNumber() {
        this.separatorsNumber = this.format.length - 1;
    }
    setResultLength() {
        let resLength = 0;
        this.format.forEach(value => {
            resLength += value.length;
        });
        this.resultLength = resLength + this.separatorsNumber;
    }
    getFormattedDate(date) {
        const dateParts = this.getDateParts(date);
        const result = dateParts.map((part, index) => {
            return this.formatDateParts(part, index);
        });
        return result.join(this.separator).slice(0, this.resultLength);
    }
    getDateParts(date) {
        date = this.getDigits(date).slice(0, this.resultLength - this.separatorsNumber);
        const parts = [];
        const partsIndex = {
            first: this.format[0].length,
            mid: this.format[0].length + this.format[1].length,
            last: this.resultLength,
        };
        parts[0] = date.slice(0, partsIndex.first);
        if (date.length > partsIndex.first) {
            parts[1] = date.slice(partsIndex.first, partsIndex.mid);
        }
        if (date.length > partsIndex.mid) {
            parts[2] = date.slice(partsIndex.mid, partsIndex.last);
        }
        return parts;
    }
    getDigits(value) {
        return value.replace(/\D/g, '');
    }
    formatDateParts(datePart, index) {
        switch (this.format[index]) {
            case 'dd':
                datePart = this.getFormattedDay(datePart);
                break;
            case 'mm':
                datePart = this.getFormattedMonth(datePart);
                break;
        }
        return datePart;
    }
    getFormattedDay(value) {
        const dayFirstNum = parseInt(value.charAt(0), 10);
        if (value) {
            if (dayFirstNum > 3 && dayFirstNum !== 0) {
                return '0' + value.charAt(0);
            }
            else {
                return value;
            }
        }
    }
    getFormattedMonth(value) {
        const monthFirstNum = parseInt(value.charAt(0), 10);
        const monthNum = parseInt(value, 10);
        if (value) {
            if (monthFirstNum > 1 && monthFirstNum !== 0) {
                return '0' + value.charAt(0);
            }
            else if (monthNum > 12) {
                return '12';
            }
            else {
                return value;
            }
        }
    }
}
MdbDateFormatDirective.ɵfac = function MdbDateFormatDirective_Factory(t) { return new (t || MdbDateFormatDirective)(); };
MdbDateFormatDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MdbDateFormatDirective, selectors: [["", "mdbDateFormat", ""]], hostBindings: function MdbDateFormatDirective_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("input", function MdbDateFormatDirective_input_HostBindingHandler($event) { return ctx.onInput($event); })("paste", function MdbDateFormatDirective_paste_HostBindingHandler($event) { return ctx.onInput($event); });
    } }, inputs: { separator: "separator", format: "format" } });
MdbDateFormatDirective.propDecorators = {
    separator: [{ type: Input }],
    format: [{ type: Input }],
    onInput: [{ type: HostListener, args: ['input', ['$event'],] }, { type: HostListener, args: ['paste', ['$event'],] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MdbDateFormatDirective, [{
        type: Directive,
        args: [{
                selector: '[mdbDateFormat]'
            }]
    }], function () { return []; }, { separator: [{
            type: Input
        }], format: [{
            type: Input
        }], onInput: [{
            type: HostListener,
            args: ['input', ['$event']]
        }, {
            type: HostListener,
            args: ['paste', ['$event']]
        }] }); })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWRiLWRhdGUtZm9ybWF0LmRpcmVjdGl2ZS5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmctdWlraXQtcHJvLXN0YW5kYXJkL3NyYy9saWIvcHJvL2F1dG8tZm9ybWF0L21kYi1kYXRlLWZvcm1hdC5kaXJlY3RpdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDOztBQUt2RSxNQUFNLE9BQU8sc0JBQXNCO0FBQUksSUFIdkM7QUFDSSxRQU1PLGNBQVMsR0FBRyxHQUFHLENBQUM7QUFDMUIsUUFBVSxXQUFNLEdBQUcsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBRXpDLElBb0dBLENBQUM7QUFDQSxJQW5HQyxPQUFPLENBQUMsS0FBVTtBQUNuQixRQUFHLE1BQU0sWUFBWSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDO0FBQzNDLFFBQUcsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQ3hELFFBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsUUFBUSxDQUFDO0FBQ2pDLElBQUMsQ0FBQztBQUVILElBQUUsUUFBUTtBQUNULFFBQUcsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7QUFDOUIsUUFBRyxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7QUFDMUIsSUFBQyxDQUFDO0FBRUgsSUFBRSxtQkFBbUI7QUFDcEIsUUFBRyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO0FBQ2xELElBQUMsQ0FBQztBQUVILElBQUUsZUFBZTtBQUNoQixRQUFHLElBQUksU0FBUyxHQUFHLENBQUMsQ0FBQztBQUNyQixRQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsT0FB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QUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFDQSxBQUFBLEFBN0dBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFLQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGlyZWN0aXZlLCBIb3N0TGlzdGVuZXIsIElucHV0LCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuQERpcmVjdGl2ZSh7XG4gIHNlbGVjdG9yOiAnW21kYkRhdGVGb3JtYXRdJyxcbn0pXG5leHBvcnQgY2xhc3MgTWRiRGF0ZUZvcm1hdERpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIHJlc3VsdExlbmd0aDogbnVtYmVyO1xuICBzZXBhcmF0b3JzTnVtYmVyOiBudW1iZXI7XG5cbiAgQElucHV0KCkgc2VwYXJhdG9yID0gJy8nO1xuICBASW5wdXQoKSBmb3JtYXQgPSBbJ2RkJywgJ21tJywgJ3l5eXknXTtcblxuICBASG9zdExpc3RlbmVyKCdpbnB1dCcsIFsnJGV2ZW50J10pXG4gIEBIb3N0TGlzdGVuZXIoJ3Bhc3RlJywgWyckZXZlbnQnXSlcbiAgb25JbnB1dChldmVudDogYW55KSB7XG4gICAgY29uc3QgY3VycmVudFZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgIGNvbnN0IG5ld1ZhbHVlID0gdGhpcy5nZXRGb3JtYXR0ZWREYXRlKGN1cnJlbnRWYWx1ZSk7XG4gICAgZXZlbnQudGFyZ2V0LnZhbHVlID0gbmV3VmFsdWU7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLnNldFNlcGFyYXRvcnNOdW1iZXIoKTtcbiAgICB0aGlzLnNldFJlc3VsdExlbmd0aCgpO1xuICB9XG5cbiAgc2V0U2VwYXJhdG9yc051bWJlcigpIHtcbiAgICB0aGlzLnNlcGFyYXRvcnNOdW1iZXIgPSB0aGlzLmZvcm1hdC5sZW5ndGggLSAxO1xuICB9XG5cbiAgc2V0UmVzdWx0TGVuZ3RoKCkge1xuICAgIGxldCByZXNMZW5ndGggPSAwO1xuICAgIHRoaXMuZm9ybWF0LmZvckVhY2godmFsdWUgPT4ge1xuICAgICAgcmVzTGVuZ3RoICs9IHZhbHVlLmxlbmd0aDtcbiAgICB9KTtcbiAgICB0aGlzLnJlc3VsdExlbmd0aCA9IHJlc0xlbmd0aCArIHRoaXMuc2VwYXJhdG9yc051bWJlcjtcbiAgfVxuXG4gIGdldEZvcm1hdHRlZERhdGUoZGF0ZTogc3RyaW5nKSB7XG4gICAgY29uc3QgZGF0ZVBhcnRzID0gdGhpcy5nZXREYXRlUGFydHMoZGF0ZSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBkYXRlUGFydHMubWFwKChwYXJ0LCBpbmRleCkgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0RGF0ZVBhcnRzKHBhcnQsIGluZGV4KTtcbiAgICB9KTtcblxuICAgIHJldHVybiByZXN1bHQuam9pbih0aGlzLnNlcGFyYXRvcikuc2xpY2UoMCwgdGhpcy5yZXN1bHRMZW5ndGgpO1xuICB9XG5cbiAgZ2V0RGF0ZVBhcnRzKGRhdGU6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBkYXRlID0gdGhpcy5nZXREaWdpdHMoZGF0ZSkuc2xpY2UoMCwgdGhpcy5yZXN1bHRMZW5ndGggLSB0aGlzLnNlcGFyYXRvcnNOdW1iZXIpO1xuICAgIGNvbnN0IHBhcnRzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHBhcnRzSW5kZXggPSB7XG4gICAgICBmaXJzdDogdGhpcy5mb3JtYXRbMF0ubGVuZ3RoLFxuICAgICAgbWlkOiB0aGlzLmZvcm1hdFswXS5sZW5ndGggKyB0aGlzLmZvcm1hdFsxXS5sZW5ndGgsXG4gICAgICBsYXN0OiB0aGlzLnJlc3VsdExlbmd0aCxcbiAgICB9O1xuXG4gICAgcGFydHNbMF0gPSBkYXRlLnNsaWNlKDAsIHBhcnRzSW5kZXguZmlyc3QpO1xuXG4gICAgaWYgKGRhdGUubGVuZ3RoID4gcGFydHNJbmRleC5maXJzdCkge1xuICAgICAgcGFydHNbMV0gPSBkYXRlLnNsaWNlKHBhcnRzSW5kZXguZmlyc3QsIHBhcnRzSW5kZXgubWlkKTtcbiAgICB9XG5cbiAgICBpZiAoZGF0ZS5sZW5ndGggPiBwYXJ0c0luZGV4Lm1pZCkge1xuICAgICAgcGFydHNbMl0gPSBkYXRlLnNsaWNlKHBhcnRzSW5kZXgubWlkLCBwYXJ0c0luZGV4Lmxhc3QpO1xuICAgIH1cblxuICAgIHJldHVybiBwYXJ0cztcbiAgfVxuXG4gIGdldERpZ2l0cyh2YWx1ZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoL1xcRC9nLCAnJyk7XG4gIH1cblxuICBmb3JtYXREYXRlUGFydHMoZGF0ZVBhcnQ6IGFueSwgaW5kZXg6IG51bWJlcikge1xuICAgIHN3aXRjaCAodGhpcy5mb3JtYXRbaW5kZXhdKSB7XG4gICAgICBjYXNlICdkZCc6XG4gICAgICAgIGRhdGVQYXJ0ID0gdGhpcy5nZXRGb3JtYXR0ZWREYXkoZGF0ZVBhcnQpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnbW0nOlxuICAgICAgICBkYXRlUGFydCA9IHRoaXMuZ2V0Rm9ybWF0dGVkTW9udGgoZGF0ZVBhcnQpO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICByZXR1cm4gZGF0ZVBhcnQ7XG4gIH1cblxuICBnZXRGb3JtYXR0ZWREYXkodmFsdWU6IHN0cmluZykge1xuICAgIGNvbnN0IGRheUZpcnN0TnVtID0gcGFyc2VJbnQodmFsdWUuY2hhckF0KDApLCAxMCk7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBpZiAoZGF5Rmlyc3ROdW0gPiAzICYmIGRheUZpcnN0TnVtICE9PSAwKSB7XG4gICAgICAgIHJldHVybiAnMCcgKyB2YWx1ZS5jaGFyQXQoMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0Rm9ybWF0dGVkTW9udGgodmFsdWU6IHN0cmluZykge1xuICAgIGNvbnN0IG1vbnRoRmlyc3ROdW0gPSBwYXJzZUludCh2YWx1ZS5jaGFyQXQoMCksIDEwKTtcbiAgICBjb25zdCBtb250aE51bSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG5cbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIGlmIChtb250aEZpcnN0TnVtID4gMSAmJiBtb250aEZpcnN0TnVtICE9PSAwKSB7XG4gICAgICAgIHJldHVybiAnMCcgKyB2YWx1ZS5jaGFyQXQoMCk7XG4gICAgICB9IGVsc2UgaWYgKG1vbnRoTnVtID4gMTIpIHtcbiAgICAgICAgcmV0dXJuICcxMic7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXX0=