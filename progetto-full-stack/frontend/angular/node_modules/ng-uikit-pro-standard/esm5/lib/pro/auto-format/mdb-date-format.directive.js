import { __decorate, __metadata } from "tslib";
import { Directive, HostListener, Input } from '@angular/core';
import * as ɵngcc0 from '@angular/core';
var MdbDateFormatDirective = /** @class */ (function () {
    function MdbDateFormatDirective() {
        this.separator = '/';
        this.format = ['dd', 'mm', 'yyyy'];
    }
    MdbDateFormatDirective.prototype.onInput = function (event) {
        var currentValue = event.target.value;
        var newValue = this.getFormattedDate(currentValue);
        event.target.value = newValue;
    };
    MdbDateFormatDirective.prototype.ngOnInit = function () {
        this.setSeparatorsNumber();
        this.setResultLength();
    };
    MdbDateFormatDirective.prototype.setSeparatorsNumber = function () {
        this.separatorsNumber = this.format.length - 1;
    };
    MdbDateFormatDirective.prototype.setResultLength = function () {
        var resLength = 0;
        this.format.forEach(function (value) {
            resLength += value.length;
        });
        this.resultLength = resLength + this.separatorsNumber;
    };
    MdbDateFormatDirective.prototype.getFormattedDate = function (date) {
        var _this = this;
        var dateParts = this.getDateParts(date);
        var result = dateParts.map(function (part, index) {
            return _this.formatDateParts(part, index);
        });
        return result.join(this.separator).slice(0, this.resultLength);
    };
    MdbDateFormatDirective.prototype.getDateParts = function (date) {
        date = this.getDigits(date).slice(0, this.resultLength - this.separatorsNumber);
        var parts = [];
        var partsIndex = {
            first: this.format[0].length,
            mid: this.format[0].length + this.format[1].length,
            last: this.resultLength,
        };
        parts[0] = date.slice(0, partsIndex.first);
        if (date.length > partsIndex.first) {
            parts[1] = date.slice(partsIndex.first, partsIndex.mid);
        }
        if (date.length > partsIndex.mid) {
            parts[2] = date.slice(partsIndex.mid, partsIndex.last);
        }
        return parts;
    };
    MdbDateFormatDirective.prototype.getDigits = function (value) {
        return value.replace(/\D/g, '');
    };
    MdbDateFormatDirective.prototype.formatDateParts = function (datePart, index) {
        switch (this.format[index]) {
            case 'dd':
                datePart = this.getFormattedDay(datePart);
                break;
            case 'mm':
                datePart = this.getFormattedMonth(datePart);
                break;
        }
        return datePart;
    };
    MdbDateFormatDirective.prototype.getFormattedDay = function (value) {
        var dayFirstNum = parseInt(value.charAt(0), 10);
        if (value) {
            if (dayFirstNum > 3 && dayFirstNum !== 0) {
                return '0' + value.charAt(0);
            }
            else {
                return value;
            }
        }
    };
    MdbDateFormatDirective.prototype.getFormattedMonth = function (value) {
        var monthFirstNum = parseInt(value.charAt(0), 10);
        var monthNum = parseInt(value, 10);
        if (value) {
            if (monthFirstNum > 1 && monthFirstNum !== 0) {
                return '0' + value.charAt(0);
            }
            else if (monthNum > 12) {
                return '12';
            }
            else {
                return value;
            }
        }
    };
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], MdbDateFormatDirective.prototype, "separator", void 0);
    __decorate([
        Input(),
        __metadata("design:type", Object)
    ], MdbDateFormatDirective.prototype, "format", void 0);
    __decorate([
        HostListener('input', ['$event']),
        HostListener('paste', ['$event']),
        __metadata("design:type", Function),
        __metadata("design:paramtypes", [Object]),
        __metadata("design:returntype", void 0)
    ], MdbDateFormatDirective.prototype, "onInput", null);
MdbDateFormatDirective.ɵfac = function MdbDateFormatDirective_Factory(t) { return new (t || MdbDateFormatDirective)(); };
MdbDateFormatDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: MdbDateFormatDirective, selectors: [["", "mdbDateFormat", ""]], hostBindings: function MdbDateFormatDirective_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("input", function MdbDateFormatDirective_input_HostBindingHandler($event) { return ctx.onInput($event); })("paste", function MdbDateFormatDirective_paste_HostBindingHandler($event) { return ctx.onInput($event); });
    } }, inputs: { separator: "separator", format: "format" } });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(MdbDateFormatDirective, [{
        type: Directive,
        args: [{
                selector: '[mdbDateFormat]'
            }]
    }], function () { return []; }, { separator: [{
            type: Input
        }], format: [{
            type: Input
        }], onInput: [{
            type: HostListener,
            args: ['input', ['$event']]
        }, {
            type: HostListener,
            args: ['paste', ['$event']]
        }] }); })();
    return MdbDateFormatDirective;
}());
export { MdbDateFormatDirective };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWRiLWRhdGUtZm9ybWF0LmRpcmVjdGl2ZS5qcyIsInNvdXJjZXMiOlsibmctdWlraXQtcHJvLXN0YW5kYXJkL2xpYi9wcm8vYXV0by1mb3JtYXQvbWRiLWRhdGUtZm9ybWF0LmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDOztBQUt2RTtBQUNHLElBREg7QUFBcUMsUUFJMUIsY0FBUyxHQUFHLEdBQUcsQ0FBQztBQUMxQixRQUFVLFdBQU0sR0FBRyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFFekMsSUFvR0EsQ0FBQztBQUNBLElBbkdDLHdDQUFPLEdBQVAsVUFBUSxLQUFVO0FBQ25CLFFBQUcsSUFBTSxZQUFZLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUM7QUFDM0MsUUFBRyxJQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDeEQsUUFBRyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxRQUFRLENBQUM7QUFDakMsSUFBQyxDQUFDO0FBRUYsSUFBQyx5Q0FBUSxHQUFSO0FBQ0EsUUFBRSxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztBQUM5QixRQUFHLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztBQUMxQixJQUFDLENBQUM7QUFFRixJQUFDLG9EQUFtQixHQUFuQjtBQUFlLFFBQ2IsSUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztBQUNsRCxJQUFDLENBQUM7QUFFRixJQUFDLGdEQUFlLEdBQWY7QUFBZSxRQUNiLElBQUksU0FBUyxHQUFHLENBQUMsQ0FBQztBQUNyQixRQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQUEsS0FBSztBQUFLLFlB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LEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQVFBLEFBUEEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQ0EsQUFBQSxBQXRHQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUlBLEFBRkEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBS0EsQUFiQSxBQUFBLEFBSEEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQTJHQSxBQUFBLEFBQUEsQUFBQSxBQTNHQSxBQTJHQSxBQTNHQSxBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGlyZWN0aXZlLCBIb3N0TGlzdGVuZXIsIElucHV0LCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuQERpcmVjdGl2ZSh7XG4gIHNlbGVjdG9yOiAnW21kYkRhdGVGb3JtYXRdJyxcbn0pXG5leHBvcnQgY2xhc3MgTWRiRGF0ZUZvcm1hdERpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIHJlc3VsdExlbmd0aDogbnVtYmVyO1xuICBzZXBhcmF0b3JzTnVtYmVyOiBudW1iZXI7XG5cbiAgQElucHV0KCkgc2VwYXJhdG9yID0gJy8nO1xuICBASW5wdXQoKSBmb3JtYXQgPSBbJ2RkJywgJ21tJywgJ3l5eXknXTtcblxuICBASG9zdExpc3RlbmVyKCdpbnB1dCcsIFsnJGV2ZW50J10pXG4gIEBIb3N0TGlzdGVuZXIoJ3Bhc3RlJywgWyckZXZlbnQnXSlcbiAgb25JbnB1dChldmVudDogYW55KSB7XG4gICAgY29uc3QgY3VycmVudFZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgIGNvbnN0IG5ld1ZhbHVlID0gdGhpcy5nZXRGb3JtYXR0ZWREYXRlKGN1cnJlbnRWYWx1ZSk7XG4gICAgZXZlbnQudGFyZ2V0LnZhbHVlID0gbmV3VmFsdWU7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLnNldFNlcGFyYXRvcnNOdW1iZXIoKTtcbiAgICB0aGlzLnNldFJlc3VsdExlbmd0aCgpO1xuICB9XG5cbiAgc2V0U2VwYXJhdG9yc051bWJlcigpIHtcbiAgICB0aGlzLnNlcGFyYXRvcnNOdW1iZXIgPSB0aGlzLmZvcm1hdC5sZW5ndGggLSAxO1xuICB9XG5cbiAgc2V0UmVzdWx0TGVuZ3RoKCkge1xuICAgIGxldCByZXNMZW5ndGggPSAwO1xuICAgIHRoaXMuZm9ybWF0LmZvckVhY2godmFsdWUgPT4ge1xuICAgICAgcmVzTGVuZ3RoICs9IHZhbHVlLmxlbmd0aDtcbiAgICB9KTtcbiAgICB0aGlzLnJlc3VsdExlbmd0aCA9IHJlc0xlbmd0aCArIHRoaXMuc2VwYXJhdG9yc051bWJlcjtcbiAgfVxuXG4gIGdldEZvcm1hdHRlZERhdGUoZGF0ZTogc3RyaW5nKSB7XG4gICAgY29uc3QgZGF0ZVBhcnRzID0gdGhpcy5nZXREYXRlUGFydHMoZGF0ZSk7XG5cbiAgICBjb25zdCByZXN1bHQgPSBkYXRlUGFydHMubWFwKChwYXJ0LCBpbmRleCkgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0RGF0ZVBhcnRzKHBhcnQsIGluZGV4KTtcbiAgICB9KTtcblxuICAgIHJldHVybiByZXN1bHQuam9pbih0aGlzLnNlcGFyYXRvcikuc2xpY2UoMCwgdGhpcy5yZXN1bHRMZW5ndGgpO1xuICB9XG5cbiAgZ2V0RGF0ZVBhcnRzKGRhdGU6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBkYXRlID0gdGhpcy5nZXREaWdpdHMoZGF0ZSkuc2xpY2UoMCwgdGhpcy5yZXN1bHRMZW5ndGggLSB0aGlzLnNlcGFyYXRvcnNOdW1iZXIpO1xuICAgIGNvbnN0IHBhcnRzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHBhcnRzSW5kZXggPSB7XG4gICAgICBmaXJzdDogdGhpcy5mb3JtYXRbMF0ubGVuZ3RoLFxuICAgICAgbWlkOiB0aGlzLmZvcm1hdFswXS5sZW5ndGggKyB0aGlzLmZvcm1hdFsxXS5sZW5ndGgsXG4gICAgICBsYXN0OiB0aGlzLnJlc3VsdExlbmd0aCxcbiAgICB9O1xuXG4gICAgcGFydHNbMF0gPSBkYXRlLnNsaWNlKDAsIHBhcnRzSW5kZXguZmlyc3QpO1xuXG4gICAgaWYgKGRhdGUubGVuZ3RoID4gcGFydHNJbmRleC5maXJzdCkge1xuICAgICAgcGFydHNbMV0gPSBkYXRlLnNsaWNlKHBhcnRzSW5kZXguZmlyc3QsIHBhcnRzSW5kZXgubWlkKTtcbiAgICB9XG5cbiAgICBpZiAoZGF0ZS5sZW5ndGggPiBwYXJ0c0luZGV4Lm1pZCkge1xuICAgICAgcGFydHNbMl0gPSBkYXRlLnNsaWNlKHBhcnRzSW5kZXgubWlkLCBwYXJ0c0luZGV4Lmxhc3QpO1xuICAgIH1cblxuICAgIHJldHVybiBwYXJ0cztcbiAgfVxuXG4gIGdldERpZ2l0cyh2YWx1ZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHZhbHVlLnJlcGxhY2UoL1xcRC9nLCAnJyk7XG4gIH1cblxuICBmb3JtYXREYXRlUGFydHMoZGF0ZVBhcnQ6IGFueSwgaW5kZXg6IG51bWJlcikge1xuICAgIHN3aXRjaCAodGhpcy5mb3JtYXRbaW5kZXhdKSB7XG4gICAgICBjYXNlICdkZCc6XG4gICAgICAgIGRhdGVQYXJ0ID0gdGhpcy5nZXRGb3JtYXR0ZWREYXkoZGF0ZVBhcnQpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnbW0nOlxuICAgICAgICBkYXRlUGFydCA9IHRoaXMuZ2V0Rm9ybWF0dGVkTW9udGgoZGF0ZVBhcnQpO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICByZXR1cm4gZGF0ZVBhcnQ7XG4gIH1cblxuICBnZXRGb3JtYXR0ZWREYXkodmFsdWU6IHN0cmluZykge1xuICAgIGNvbnN0IGRheUZpcnN0TnVtID0gcGFyc2VJbnQodmFsdWUuY2hhckF0KDApLCAxMCk7XG4gICAgaWYgKHZhbHVlKSB7XG4gICAgICBpZiAoZGF5Rmlyc3ROdW0gPiAzICYmIGRheUZpcnN0TnVtICE9PSAwKSB7XG4gICAgICAgIHJldHVybiAnMCcgKyB2YWx1ZS5jaGFyQXQoMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0Rm9ybWF0dGVkTW9udGgodmFsdWU6IHN0cmluZykge1xuICAgIGNvbnN0IG1vbnRoRmlyc3ROdW0gPSBwYXJzZUludCh2YWx1ZS5jaGFyQXQoMCksIDEwKTtcbiAgICBjb25zdCBtb250aE51bSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG5cbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIGlmIChtb250aEZpcnN0TnVtID4gMSAmJiBtb250aEZpcnN0TnVtICE9PSAwKSB7XG4gICAgICAgIHJldHVybiAnMCcgKyB2YWx1ZS5jaGFyQXQoMCk7XG4gICAgICB9IGVsc2UgaWYgKG1vbnRoTnVtID4gMTIpIHtcbiAgICAgICAgcmV0dXJuICcxMic7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXX0=